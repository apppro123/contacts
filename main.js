/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

class AlertModal extends obsidian.Modal {
    constructor(app) {
        super(app);
    }
    setText(alertMessage) {
        this.alertMessage = alertMessage;
    }
    onOpen() {
        let { contentEl } = this;
        contentEl.setText(this.alertMessage);
        window.setInterval(() => this.close(), 5 * 1000);
    }
    onClose() {
        let { contentEl } = this;
        contentEl.empty();
    }
}

function isMarkdownView(app) {
    const { workspace } = app;
    const activeView = workspace.getActiveViewOfType(obsidian.MarkdownView);
    return activeView;
}
function getMarkdownData(app) {
    const activeView = app.workspace.getActiveViewOfType(obsidian.MarkdownView);
    return activeView.getViewData();
}

const LINE_BREAK = "\n";
class ContactsModal extends obsidian.Modal {
    constructor(app, plugin) {
        super(app);
        this.plugin = plugin;
    }
    setEmptyContactFields() {
        //create form
        this.createForm();
        const inputNames = this.plugin.settings.contactFields;
        this.createFields(inputNames);
        //create append button here to have possibility to pass arguments to function
        this.createAddButton();
    }
    createForm() {
        const form = this.contentEl.createEl("form");
        form.id = "contactsModalForm";
    }
    createFields(names, values) {
        let { contentEl } = this;
        const form = document.getElementById("contactsModalForm");
        //go over inputs, create and add them to form element
        for (let i = 0; i < names.length; i++) {
            const name = names[i];
            //create element
            const newInput = contentEl.createEl("input");
            newInput.name = name;
            newInput.placeholder = name;
            if (values) {
                const value = values[i];
                newInput.value = value;
            }
            //set focus on first input
            if (i === 0) {
                newInput.focus();
            }
            //append all inputs/elements to form
            form.appendChild(newInput);
        }
    }
    createAddButton() {
        const addButton = this.contentEl.createEl("button", { text: "add" });
        addButton.addEventListener("click", () => {
            const form = document.getElementById("contactsModalForm");
            const contactFileIdentifier = "#contact";
            let newContactText = contactFileIdentifier + LINE_BREAK.repeat(2);
            //append values of input fields
            Object.values(form).reduce((obj, field) => {
                const { name, value } = field;
                /* //search for headings
                if(name.startsWith("h1")){
                    newContactText += "# "
                } else if(name.startsWith("h2")){
                    newContactText += "## "
                } else {
                    //other ideas??
                    //two line breaks??
                    newContactText += "- "
                } */
                const newContactTitle = "#" + name;
                const newContactValue = value.toString();
                newContactText += newContactTitle + " " + newContactValue + LINE_BREAK;
            }, {});
            this.addTextToActiveFile(newContactText);
            this.close();
        });
    }
    addTextToActiveFile(text) {
        return __awaiter(this, void 0, void 0, function* () {
            const activeView = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView);
            const editor = activeView.editor;
            const doc = editor.getDoc();
            doc.replaceSelection(text);
        });
    }
    onOpen() {
        if (!isMarkdownView(this.app)) {
            const alertModal = new AlertModal(this.app);
            alertModal.setText('Not a markdown view, cannot set contact.');
            return;
        }
        if (this.hasAlreadyContact()) {
            const viewData = getMarkdownData(this.app);
            this.setAndFillContactFields(viewData);
        }
        else {
            this.setEmptyContactFields();
        }
        const form = document.getElementById("contactsModalForm");
        form.firstElementChild.focus();
    }
    onClose() {
        let { contentEl } = this;
        contentEl.empty();
    }
    /**
     * at the moment just tests if #contact is at the beginning of the view
     * @returns boolean
     */
    hasAlreadyContact() {
        // this.plugin.registerCodeMirror();
        const markdownData = getMarkdownData(this.app);
        return markdownData.trim().startsWith("#contact");
    }
    setAndFillContactFields(viewData) {
        const fieldsData = this.getFieldsWithValues(viewData);
        const fieldNames = fieldsData[0];
        const fieldValues = fieldsData[1];
        //create form
        this.createForm();
        this.createFields(fieldNames, fieldValues);
        //create append button here to have possibility to pass arguments to function
        this.createAddButton();
    }
    getFieldsWithValues(viewData) {
        const searchKeyword = "#";
        // length of string #contact
        const startIndex = 8;
        let indexOccurence = viewData.indexOf(searchKeyword, startIndex);
        let fieldNames = [];
        let fieldValues = [];
        // if not found it is -1 and stops the loop
        while (indexOccurence >= 0) {
            //increment indexOccurence because I dont need # itself
            const indexNextSpace = viewData.indexOf(" ", indexOccurence + 1);
            const name = viewData.substring(indexOccurence + 1, indexNextSpace);
            fieldNames.push(name);
            const indexNewLine = viewData.indexOf("\n", indexNextSpace);
            let value = "";
            if (indexNewLine > 0) {
                value = viewData.substring(indexNextSpace + 1, indexNewLine);
            }
            else {
                value = viewData.substring(indexNextSpace + 1);
            }
            fieldValues.push(value);
            indexOccurence = viewData.indexOf(searchKeyword, indexOccurence + 1);
        }
        return [fieldNames, fieldValues];
    }
}

const DEFAULT_SETTINGS = {
    contactFields: ['firstname', 'lastname', 'age']
};
class ContactsSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.newFieldValue = "";
        this.app = app;
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Contacts plugin settings' });
        this.addContactFieldsOverview();
        this.addAddFieldButton();
        this.addContactsHotkey();
    }
    addContactFieldsOverview() {
        this.addContactFieldsOverviewTitle();
        this.addContactFields();
    }
    addContactFieldsOverviewTitle() {
        new obsidian.Setting(this.containerEl)
            .setName('contact fields')
            .setDesc('overview over the contact fields with the possibility to execute certain actions');
    }
    addContactFields() {
        const allContactFields = this.plugin.settings.contactFields;
        for (const contactField of allContactFields) {
            new obsidian.Setting(this.containerEl)
                .addText((text) => {
                text
                    .setValue(contactField)
                    .setDisabled(true);
            });
        }
    }
    addAddFieldButton() {
        new obsidian.Setting(this.containerEl)
            .setName("Add New")
            .setDesc("Add new field for contact")
            .addText((text) => {
            text
                .setPlaceholder('name of new field')
                .onChange((value) => {
                this.newFieldValue = value;
            });
        })
            .addButton((button) => {
            button
                .setTooltip("Add another field")
                .setButtonText("+")
                .setCta() // probably Cta = call to action, so different styles
                .onClick(() => {
                const trimmedNewFieldValue = this.newFieldValue.trim();
                if (trimmedNewFieldValue === "") {
                    const alertModal = new AlertModal(this.app);
                    alertModal.setText('Please fill something in input field!');
                    alertModal.open();
                    return;
                }
                else if (!this.isOnlyAlphabeticCharacters(trimmedNewFieldValue)) {
                    const alertModal = new AlertModal(this.app);
                    alertModal.setText('Just alphabetic characters are allowed');
                    alertModal.open();
                    return;
                }
                this.plugin.settings.contactFields.push(this.newFieldValue);
                this.plugin.saveSettings();
                this.display();
            });
        });
    }
    isOnlyAlphabeticCharacters(trimmedValue) {
        const regex = /^[a-z]+$/i;
        return regex.test(trimmedValue);
    }
    addContactsHotkey() {
        /* new Setting(this.containerEl)
            .setName('add/edit contact')
            .setDesc('hokey for adding or, if already an contact is in this page, edit it') */
        this.plugin.addCommand({
            id: 'createEditContact',
            name: 'create or edit contact',
            hotkeys: [
                {
                    modifiers: ["Alt"],
                    key: "C",
                },
            ],
            editorCallback: () => {
                const contactsModal = new ContactsModal(this.app, this.plugin);
                contactsModal.open();
            }
        });
    }
}

/* import PatternSearchOnKeyDown from './handleKeysInMarkdown';

import ContactsModal  from './contactsModal';

const CONTACT_PATTERN = "::contact"; */
class ContactsPlugin extends obsidian.Plugin {
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            this.loadSettings();
            /*
            const patternSearchOnKeyDown = new PatternSearchOnKeyDown(this);
            
            const contactsModal = new ContactsModal(this.app, this);
            patternSearchOnKeyDown.callbackOnPattern(CONTACT_PATTERN, contactsModal.openContactsModal);
            */
            this.addSettingTab(new ContactsSettingTab(this.app, this));
        });
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
}

module.exports = ContactsPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsInNyYy9hbGVydE1vZGFsLnRzIiwic3JjL3V0aWxzLnRzIiwic3JjL2NvbnRhY3RzTW9kYWwudHMiLCJzcmMvc2V0dGluZ3MudHMiLCJzcmMvbWFpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2NyZWF0ZUJpbmRpbmcgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH0pO1xyXG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIG9bazJdID0gbVtrXTtcclxufSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIG8pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbSwgcGFjaykge1xyXG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XHJcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XHJcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xyXG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEdldChyZWNlaXZlciwgc3RhdGUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHJlYWQgcHJpdmF0ZSBtZW1iZXIgZnJvbSBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIGtpbmQgPT09IFwibVwiID8gZiA6IGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyKSA6IGYgPyBmLnZhbHVlIDogc3RhdGUuZ2V0KHJlY2VpdmVyKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRTZXQocmVjZWl2ZXIsIHN0YXRlLCB2YWx1ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgc2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3Qgd3JpdGUgcHJpdmF0ZSBtZW1iZXIgdG8gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xyXG59XHJcbiIsImltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFsZXJ0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBhbGVydE1lc3NhZ2U6IHN0cmluZztcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuXHRcdHN1cGVyKGFwcCk7XG5cblx0fVxuXG4gICAgc2V0VGV4dChhbGVydE1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZSA9IGFsZXJ0TWVzc2FnZTtcbiAgICB9XG5cblx0b25PcGVuKCkge1xuXHRcdGxldCB7Y29udGVudEVsfSA9IHRoaXM7XG5cdFx0Y29udGVudEVsLnNldFRleHQodGhpcy5hbGVydE1lc3NhZ2UpO1xuXG4gICAgICAgIHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB0aGlzLmNsb3NlKCksIDUgKiAxMDAwKTtcblx0fVxuXG5cdG9uQ2xvc2UoKSB7XG5cdFx0bGV0IHtjb250ZW50RWx9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblx0fVxufSIsImltcG9ydCB7QXBwLCBNYXJrZG93blZpZXd9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNNYXJrZG93blZpZXcoYXBwOiBBcHApOiBNYXJrZG93blZpZXcge1xuICAgIGNvbnN0IHsgd29ya3NwYWNlIH0gPSBhcHA7XG4gICAgY29uc3QgYWN0aXZlVmlldyA9IHdvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgcmV0dXJuIGFjdGl2ZVZpZXc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXJrZG93bkRhdGEoYXBwOiBBcHApOiBzdHJpbmcge1xuICAgIGNvbnN0IGFjdGl2ZVZpZXcgPVxuICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgcmV0dXJuIGFjdGl2ZVZpZXcuZ2V0Vmlld0RhdGEoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VDYW1lbENhc2Uoc3RyaW5nVG9UcmFuc2Zvcm06IHN0cmluZyk6IHN0cmluZyB7XG4gICAgc3RyaW5nVG9UcmFuc2Zvcm1cbiAgICAgICAgLnJlcGxhY2UoL1xccyguKS9nLCBmdW5jdGlvbihjaGFyYWN0ZXI6IHN0cmluZykgeyByZXR1cm4gY2hhcmFjdGVyLnRvVXBwZXJDYXNlKCk7IH0pXG4gICAgICAgIC5yZXBsYWNlKC9cXHMvZywgJycpXG4gICAgICAgIC5yZXBsYWNlKC9eKC4pLywgZnVuY3Rpb24oY2hhcmFjdGVyOiBzdHJpbmcpIHsgcmV0dXJuIGNoYXJhY3Rlci50b0xvd2VyQ2FzZSgpOyB9KTtcbiAgICByZXR1cm4gc3RyaW5nVG9UcmFuc2Zvcm07XG59IiwiaW1wb3J0IHsgTW9kYWwsIEFwcCwgTWFya2Rvd25WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEFsZXJ0TW9kYWwgZnJvbSAnLi9hbGVydE1vZGFsJztcbmltcG9ydCBDb250YWN0c1BsdWdpbiBmcm9tIFwiLi9tYWluXCI7XG5pbXBvcnQgeyBpc01hcmtkb3duVmlldywgZ2V0TWFya2Rvd25EYXRhIH0gZnJvbSAnLi91dGlscyc7XG5cbmNvbnN0IExJTkVfQlJFQUsgPSBcIlxcblwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb250YWN0c01vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRwbHVnaW46IENvbnRhY3RzUGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IENvbnRhY3RzUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdHNldEVtcHR5Q29udGFjdEZpZWxkcygpIHtcblx0XHQvL2NyZWF0ZSBmb3JtXG5cdFx0dGhpcy5jcmVhdGVGb3JtKCk7XG5cblx0XHRjb25zdCBpbnB1dE5hbWVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGFjdEZpZWxkcztcblxuXHRcdHRoaXMuY3JlYXRlRmllbGRzKGlucHV0TmFtZXMpO1xuXG5cdFx0Ly9jcmVhdGUgYXBwZW5kIGJ1dHRvbiBoZXJlIHRvIGhhdmUgcG9zc2liaWxpdHkgdG8gcGFzcyBhcmd1bWVudHMgdG8gZnVuY3Rpb25cblx0XHR0aGlzLmNyZWF0ZUFkZEJ1dHRvbigpO1xuXHR9XG5cblx0Y3JlYXRlRm9ybSgpIHtcblx0XHRjb25zdCBmb3JtID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJmb3JtXCIpO1xuXHRcdGZvcm0uaWQgPSBcImNvbnRhY3RzTW9kYWxGb3JtXCI7XG5cdH1cblxuXHRjcmVhdGVGaWVsZHMobmFtZXM6IHN0cmluZ1tdLCB2YWx1ZXM/OiBzdHJpbmdbXSkge1xuXHRcdGxldCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuXHRcdGNvbnN0IGZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbnRhY3RzTW9kYWxGb3JtXCIpIGFzIEhUTUxGb3JtRWxlbWVudDtcblxuXHRcdC8vZ28gb3ZlciBpbnB1dHMsIGNyZWF0ZSBhbmQgYWRkIHRoZW0gdG8gZm9ybSBlbGVtZW50XG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBuYW1lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0Y29uc3QgbmFtZSA9IG5hbWVzW2ldO1xuXHRcdFx0Ly9jcmVhdGUgZWxlbWVudFxuXHRcdFx0Y29uc3QgbmV3SW5wdXQgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpbnB1dFwiKTtcblx0XHRcdG5ld0lucHV0Lm5hbWUgPSBuYW1lO1xuXHRcdFx0bmV3SW5wdXQucGxhY2Vob2xkZXIgPSBuYW1lO1xuXHRcdFx0aWYodmFsdWVzKSB7XG5cdFx0XHRcdGNvbnN0IHZhbHVlID0gdmFsdWVzW2ldO1xuXHRcdFx0XHRuZXdJbnB1dC52YWx1ZSA9IHZhbHVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvL3NldCBmb2N1cyBvbiBmaXJzdCBpbnB1dFxuXHRcdFx0aWYoaT09PTApe1xuXHRcdFx0XHRuZXdJbnB1dC5mb2N1cygpO1xuXHRcdFx0fVxuXHRcdFx0Ly9hcHBlbmQgYWxsIGlucHV0cy9lbGVtZW50cyB0byBmb3JtXG5cdFx0XHRmb3JtLmFwcGVuZENoaWxkKG5ld0lucHV0KTtcblx0XHR9XG5cdH1cblxuXHRjcmVhdGVBZGRCdXR0b24oKSB7XG5cdFx0Y29uc3QgYWRkQnV0dG9uID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcImFkZFwiIH0pO1xuXHRcdGFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0Y29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGFjdHNNb2RhbEZvcm1cIikgYXMgSFRNTEZvcm1FbGVtZW50O1xuXG5cdFx0XHRjb25zdCBjb250YWN0RmlsZUlkZW50aWZpZXIgPSBcIiNjb250YWN0XCI7XG5cblx0XHRcdGxldCBuZXdDb250YWN0VGV4dCA9IGNvbnRhY3RGaWxlSWRlbnRpZmllciArIExJTkVfQlJFQUsucmVwZWF0KDIpO1xuXHRcdFx0XG5cdFx0XHQvL2FwcGVuZCB2YWx1ZXMgb2YgaW5wdXQgZmllbGRzXG5cdFx0XHRPYmplY3QudmFsdWVzKGZvcm0pLnJlZHVjZSgob2JqLGZpZWxkKSA9PiB7IFxuXHRcdFx0XHRjb25zdCB7bmFtZSwgdmFsdWV9ID0gZmllbGQ7XG5cblx0XHRcdFx0LyogLy9zZWFyY2ggZm9yIGhlYWRpbmdzXG5cdFx0XHRcdGlmKG5hbWUuc3RhcnRzV2l0aChcImgxXCIpKXtcblx0XHRcdFx0XHRuZXdDb250YWN0VGV4dCArPSBcIiMgXCJcblx0XHRcdFx0fSBlbHNlIGlmKG5hbWUuc3RhcnRzV2l0aChcImgyXCIpKXtcblx0XHRcdFx0XHRuZXdDb250YWN0VGV4dCArPSBcIiMjIFwiXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly9vdGhlciBpZGVhcz8/XG5cdFx0XHRcdFx0Ly90d28gbGluZSBicmVha3M/P1xuXHRcdFx0XHRcdG5ld0NvbnRhY3RUZXh0ICs9IFwiLSBcIlxuXHRcdFx0XHR9ICovXG5cdFx0XHRcdGNvbnN0IG5ld0NvbnRhY3RUaXRsZSA9IFwiI1wiICsgbmFtZTtcblx0XHRcdFx0Y29uc3QgbmV3Q29udGFjdFZhbHVlID0gIHZhbHVlLnRvU3RyaW5nKCk7XG5cdFx0XHRcdG5ld0NvbnRhY3RUZXh0ICs9IG5ld0NvbnRhY3RUaXRsZSArIFwiIFwiICsgbmV3Q29udGFjdFZhbHVlICsgTElORV9CUkVBSzsgXG5cdFx0XHR9LCB7fSlcblx0XHRcdFxuXHRcdFx0dGhpcy5hZGRUZXh0VG9BY3RpdmVGaWxlKG5ld0NvbnRhY3RUZXh0KTtcblx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHR9KTtcblx0fVxuXG5cdGFzeW5jIGFkZFRleHRUb0FjdGl2ZUZpbGUodGV4dDogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPVxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblxuICAgICAgICBjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcbiAgICAgICAgY29uc3QgZG9jID0gZWRpdG9yLmdldERvYygpO1xuICAgICAgICBkb2MucmVwbGFjZVNlbGVjdGlvbih0ZXh0KTtcbiAgICB9XG5cblx0b25PcGVuKCkge1xuXHRcdGlmKCFpc01hcmtkb3duVmlldyh0aGlzLmFwcCkpe1xuXHRcdFx0Y29uc3QgYWxlcnRNb2RhbCA9IG5ldyBBbGVydE1vZGFsKHRoaXMuYXBwKTtcblx0XHRcdGFsZXJ0TW9kYWwuc2V0VGV4dCgnTm90IGEgbWFya2Rvd24gdmlldywgY2Fubm90IHNldCBjb250YWN0LicpXG4gICAgICAgICAgICByZXR1cm47XG5cdFx0fVxuXHRcdGlmKHRoaXMuaGFzQWxyZWFkeUNvbnRhY3QoKSkge1xuXHRcdFx0Y29uc3Qgdmlld0RhdGEgPSBnZXRNYXJrZG93bkRhdGEodGhpcy5hcHApO1xuXHRcdFx0dGhpcy5zZXRBbmRGaWxsQ29udGFjdEZpZWxkcyh2aWV3RGF0YSk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5zZXRFbXB0eUNvbnRhY3RGaWVsZHMoKTtcblx0XHR9XG5cdFx0Y29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGFjdHNNb2RhbEZvcm1cIikgYXMgSFRNTEZvcm1FbGVtZW50O1xuXHRcdChmb3JtLmZpcnN0RWxlbWVudENoaWxkIGFzIEhUTUxFbGVtZW50KS5mb2N1cygpO1xuXHR9XG5cblx0b25DbG9zZSgpIHtcblx0XHRsZXQgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XG5cdH1cblxuXHQvKipcblx0ICogYXQgdGhlIG1vbWVudCBqdXN0IHRlc3RzIGlmICNjb250YWN0IGlzIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIHZpZXdcblx0ICogQHJldHVybnMgYm9vbGVhblxuXHQgKi9cblx0aGFzQWxyZWFkeUNvbnRhY3QoKSB7XG5cdFx0Ly8gdGhpcy5wbHVnaW4ucmVnaXN0ZXJDb2RlTWlycm9yKCk7XG5cdFx0Y29uc3QgbWFya2Rvd25EYXRhID0gZ2V0TWFya2Rvd25EYXRhKHRoaXMuYXBwKTtcblx0XHRyZXR1cm4gbWFya2Rvd25EYXRhLnRyaW0oKS5zdGFydHNXaXRoKFwiI2NvbnRhY3RcIik7XG5cdH1cblxuXHRzZXRBbmRGaWxsQ29udGFjdEZpZWxkcyh2aWV3RGF0YTogc3RyaW5nKSB7XG5cdFx0Y29uc3QgZmllbGRzRGF0YSA9IHRoaXMuZ2V0RmllbGRzV2l0aFZhbHVlcyh2aWV3RGF0YSk7XG5cdFx0Y29uc3QgZmllbGROYW1lcyA9IGZpZWxkc0RhdGFbMF07XG5cdFx0Y29uc3QgZmllbGRWYWx1ZXMgPSBmaWVsZHNEYXRhWzFdO1xuXG5cdFx0Ly9jcmVhdGUgZm9ybVxuXHRcdHRoaXMuY3JlYXRlRm9ybSgpO1xuXG5cdFx0dGhpcy5jcmVhdGVGaWVsZHMoZmllbGROYW1lcywgZmllbGRWYWx1ZXMpO1xuXG5cdFx0Ly9jcmVhdGUgYXBwZW5kIGJ1dHRvbiBoZXJlIHRvIGhhdmUgcG9zc2liaWxpdHkgdG8gcGFzcyBhcmd1bWVudHMgdG8gZnVuY3Rpb25cblx0XHR0aGlzLmNyZWF0ZUFkZEJ1dHRvbigpO1xuXHR9XG5cblx0Z2V0RmllbGRzV2l0aFZhbHVlcyh2aWV3RGF0YTogc3RyaW5nKTogW3N0cmluZ1tdLCBzdHJpbmdbXV0ge1xuXHRcdGNvbnN0IHNlYXJjaEtleXdvcmQgPSBcIiNcIjtcblx0XHQvLyBsZW5ndGggb2Ygc3RyaW5nICNjb250YWN0XG5cdFx0Y29uc3Qgc3RhcnRJbmRleCA9IDg7IFxuXHRcdFxuXHRcdGxldCBpbmRleE9jY3VyZW5jZSA9IHZpZXdEYXRhLmluZGV4T2Yoc2VhcmNoS2V5d29yZCwgc3RhcnRJbmRleCk7XG5cblx0XHRsZXQgZmllbGROYW1lczpzdHJpbmdbXSA9IFtdO1xuXHRcdGxldCBmaWVsZFZhbHVlczogc3RyaW5nW10gPSBbXTtcblxuXHRcdC8vIGlmIG5vdCBmb3VuZCBpdCBpcyAtMSBhbmQgc3RvcHMgdGhlIGxvb3Bcblx0XHR3aGlsZShpbmRleE9jY3VyZW5jZSA+PSAwKSB7XG5cdFx0XHQvL2luY3JlbWVudCBpbmRleE9jY3VyZW5jZSBiZWNhdXNlIEkgZG9udCBuZWVkICMgaXRzZWxmXG5cdFx0XHRjb25zdCBpbmRleE5leHRTcGFjZSA9IHZpZXdEYXRhLmluZGV4T2YoXCIgXCIsIGluZGV4T2NjdXJlbmNlKzEpO1xuXHRcdFx0Y29uc3QgbmFtZSA9IHZpZXdEYXRhLnN1YnN0cmluZyhpbmRleE9jY3VyZW5jZSsxLCBpbmRleE5leHRTcGFjZSk7XG5cdFx0XHRmaWVsZE5hbWVzLnB1c2gobmFtZSk7XG5cblx0XHRcdGNvbnN0IGluZGV4TmV3TGluZSA9IHZpZXdEYXRhLmluZGV4T2YoXCJcXG5cIiwgaW5kZXhOZXh0U3BhY2UpO1xuXHRcdFx0bGV0IHZhbHVlID0gXCJcIjtcblx0XHRcdFxuXHRcdFx0aWYoaW5kZXhOZXdMaW5lID4gMCkge1xuXHRcdFx0XHR2YWx1ZSA9IHZpZXdEYXRhLnN1YnN0cmluZyhpbmRleE5leHRTcGFjZSsxLCBpbmRleE5ld0xpbmUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFsdWUgPSB2aWV3RGF0YS5zdWJzdHJpbmcoaW5kZXhOZXh0U3BhY2UrMSk7XG5cdFx0XHR9XG5cblx0XHRcdGZpZWxkVmFsdWVzLnB1c2godmFsdWUpO1xuXHRcdFx0aW5kZXhPY2N1cmVuY2UgPSB2aWV3RGF0YS5pbmRleE9mKHNlYXJjaEtleXdvcmQsIGluZGV4T2NjdXJlbmNlKzEpO1xuXHRcdH1cblx0XHRyZXR1cm4gW2ZpZWxkTmFtZXMsIGZpZWxkVmFsdWVzXTtcblx0fVxuXHRcbn0iLCJpbXBvcnQgeyBBcHAsIEJ1dHRvbkNvbXBvbmVudCwgUGx1Z2luU2V0dGluZ1RhYiwgUmVmZXJlbmNlQ2FjaGUsIFNldHRpbmcsIFRleHRDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBDb250YWN0c1BsdWdpbiBmcm9tIFwiLi9tYWluXCI7XG5pbXBvcnQgQ29udGFjdHNNb2RhbCBmcm9tIFwiLi9jb250YWN0c01vZGFsXCI7XG5cbmltcG9ydCBBbGVydE1vZGFsIGZyb20gXCIuL2FsZXJ0TW9kYWxcIjtcblxuZXhwb3J0IGludGVyZmFjZSBDb250YWN0c1BsdWdpblNldHRpbmdzIHtcblx0Y29udGFjdEZpZWxkczogQXJyYXk8c3RyaW5nPjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IENvbnRhY3RzUGx1Z2luU2V0dGluZ3MgPSB7XG5cdGNvbnRhY3RGaWVsZHM6IFsnZmlyc3RuYW1lJywgJ2xhc3RuYW1lJywgJ2FnZSddXG59XG5cbmV4cG9ydCBjbGFzcyBDb250YWN0c1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBDb250YWN0c1BsdWdpbjtcblxuICAgIG5ld0ZpZWxkVmFsdWU6IHN0cmluZyA9IFwiXCI7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogQ29udGFjdHNQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdDb250YWN0cyBwbHVnaW4gc2V0dGluZ3MnIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29udGFjdEZpZWxkc092ZXJ2aWV3KCk7XG4gICAgICAgIHRoaXMuYWRkQWRkRmllbGRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGRDb250YWN0c0hvdGtleSgpO1xuXHRcdFxuXHR9XG5cbiAgICBhZGRDb250YWN0RmllbGRzT3ZlcnZpZXcgKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZENvbnRhY3RGaWVsZHNPdmVydmlld1RpdGxlKCk7XG4gICAgICAgIHRoaXMuYWRkQ29udGFjdEZpZWxkcygpO1xuICAgIH1cblxuICAgIGFkZENvbnRhY3RGaWVsZHNPdmVydmlld1RpdGxlICgpOnZvaWQge1xuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ2NvbnRhY3QgZmllbGRzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdvdmVydmlldyBvdmVyIHRoZSBjb250YWN0IGZpZWxkcyB3aXRoIHRoZSBwb3NzaWJpbGl0eSB0byBleGVjdXRlIGNlcnRhaW4gYWN0aW9ucycpXG4gICAgfVxuXG4gICAgYWRkQ29udGFjdEZpZWxkcyAoKTp2b2lkIHtcbiAgICAgICAgY29uc3QgYWxsQ29udGFjdEZpZWxkcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRhY3RGaWVsZHM7XG4gICAgICAgIGZvcihjb25zdCBjb250YWN0RmllbGQgb2YgYWxsQ29udGFjdEZpZWxkcykge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCgodGV4dDogVGV4dENvbXBvbmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoY29udGFjdEZpZWxkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKHRydWUpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFkZEFkZEZpZWxkQnV0dG9uICgpOiB2b2lkIHtcbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJBZGQgTmV3XCIpXG4gICAgICAgIC5zZXREZXNjKFwiQWRkIG5ldyBmaWVsZCBmb3IgY29udGFjdFwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dDogVGV4dENvbXBvbmVudCkgPT4ge1xuICAgICAgICAgICAgdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignbmFtZSBvZiBuZXcgZmllbGQnKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdGaWVsZFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgLmFkZEJ1dHRvbigoYnV0dG9uOiBCdXR0b25Db21wb25lbnQpID0+IHtcbiAgICAgICAgICAgIGJ1dHRvblxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQWRkIGFub3RoZXIgZmllbGRcIilcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIitcIilcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgICAvLyBwcm9iYWJseSBDdGEgPSBjYWxsIHRvIGFjdGlvbiwgc28gZGlmZmVyZW50IHN0eWxlc1xuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJpbW1lZE5ld0ZpZWxkVmFsdWUgPSB0aGlzLm5ld0ZpZWxkVmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBpZih0cmltbWVkTmV3RmllbGRWYWx1ZSA9PT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxlcnRNb2RhbCA9IG5ldyBBbGVydE1vZGFsKHRoaXMuYXBwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0TW9kYWwuc2V0VGV4dCgnUGxlYXNlIGZpbGwgc29tZXRoaW5nIGluIGlucHV0IGZpZWxkIScpXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKCF0aGlzLmlzT25seUFscGhhYmV0aWNDaGFyYWN0ZXJzKHRyaW1tZWROZXdGaWVsZFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxlcnRNb2RhbCA9IG5ldyBBbGVydE1vZGFsKHRoaXMuYXBwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0TW9kYWwuc2V0VGV4dCgnSnVzdCBhbHBoYWJldGljIGNoYXJhY3RlcnMgYXJlIGFsbG93ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0TW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRhY3RGaWVsZHMucHVzaCh0aGlzLm5ld0ZpZWxkVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlzT25seUFscGhhYmV0aWNDaGFyYWN0ZXJzKHRyaW1tZWRWYWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gL15bYS16XSskL2lcbiAgICAgICAgcmV0dXJuIHJlZ2V4LnRlc3QodHJpbW1lZFZhbHVlKTtcbiAgICB9XG5cbiAgICBhZGRDb250YWN0c0hvdGtleSgpe1xuICAgICAgICAvKiBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ2FkZC9lZGl0IGNvbnRhY3QnKVxuICAgICAgICAgICAgLnNldERlc2MoJ2hva2V5IGZvciBhZGRpbmcgb3IsIGlmIGFscmVhZHkgYW4gY29udGFjdCBpcyBpbiB0aGlzIHBhZ2UsIGVkaXQgaXQnKSAqL1xuICAgICAgICB0aGlzLnBsdWdpbi5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnY3JlYXRlRWRpdENvbnRhY3QnLFxuICAgICAgICAgICAgbmFtZTogJ2NyZWF0ZSBvciBlZGl0IGNvbnRhY3QnLFxuICAgICAgICAgICAgaG90a2V5czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtcIkFsdFwiXSxcbiAgICAgICAgICAgICAgICBrZXk6IFwiQ1wiLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250YWN0c01vZGFsID0gbmV3IENvbnRhY3RzTW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgICAgICAgICBjb250YWN0c01vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG59IiwiaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBDb250YWN0c1BsdWdpblNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTLCBDb250YWN0c1NldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcclxuLyogaW1wb3J0IFBhdHRlcm5TZWFyY2hPbktleURvd24gZnJvbSAnLi9oYW5kbGVLZXlzSW5NYXJrZG93bic7XHJcblxyXG5pbXBvcnQgQ29udGFjdHNNb2RhbCAgZnJvbSAnLi9jb250YWN0c01vZGFsJztcclxuXHJcbmNvbnN0IENPTlRBQ1RfUEFUVEVSTiA9IFwiOjpjb250YWN0XCI7ICovXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb250YWN0c1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcblxyXG5cdHNldHRpbmdzOiBDb250YWN0c1BsdWdpblNldHRpbmdzO1xyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblxyXG5cdFx0dGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuXHJcblx0XHQvKlxyXG5cdFx0Y29uc3QgcGF0dGVyblNlYXJjaE9uS2V5RG93biA9IG5ldyBQYXR0ZXJuU2VhcmNoT25LZXlEb3duKHRoaXMpO1xyXG5cdFx0XHJcblx0XHRjb25zdCBjb250YWN0c01vZGFsID0gbmV3IENvbnRhY3RzTW9kYWwodGhpcy5hcHAsIHRoaXMpO1xyXG5cdFx0cGF0dGVyblNlYXJjaE9uS2V5RG93bi5jYWxsYmFja09uUGF0dGVybihDT05UQUNUX1BBVFRFUk4sIGNvbnRhY3RzTW9kYWwub3BlbkNvbnRhY3RzTW9kYWwpOyAgXHJcblx0XHQqL1xyXG5cclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgQ29udGFjdHNTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcblx0fVxyXG59Il0sIm5hbWVzIjpbIk1vZGFsIiwiTWFya2Rvd25WaWV3IiwiUGx1Z2luU2V0dGluZ1RhYiIsIlNldHRpbmciLCJQbHVnaW4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1REE7QUFDTyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTLEVBQUU7QUFDN0QsSUFBSSxTQUFTLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxPQUFPLEtBQUssWUFBWSxDQUFDLEdBQUcsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLFVBQVUsT0FBTyxFQUFFLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUU7QUFDaEgsSUFBSSxPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxPQUFPLENBQUMsRUFBRSxVQUFVLE9BQU8sRUFBRSxNQUFNLEVBQUU7QUFDL0QsUUFBUSxTQUFTLFNBQVMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO0FBQ25HLFFBQVEsU0FBUyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO0FBQ3RHLFFBQVEsU0FBUyxJQUFJLENBQUMsTUFBTSxF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
